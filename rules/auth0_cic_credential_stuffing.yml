# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 CIC Credential Stuffing
description: |-
  Detect credential stuffing attacks targeting Auth0's cross-origin authentication
  feature in Customer Identity Cloud (CIC) by monitoring for the following events:
  * `scoa` - Successful cross-origin authentication
  * `fcoa` - Failed cross-origin authentication
  * `pwd_leak` - Someone attempted to login with a breached password
enabled: true
severity: High
query_text: |-
  @scnr.source_type:auth0
  data.type:(scoa fcoa pwd_leak)
  | groupbycount(data.user_id)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- high_severity_alerts
tags:
- tactics.ta0006.credential_access
- techniques.t1110.brute_force
- source.auth0
